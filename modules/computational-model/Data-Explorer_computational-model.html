
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Explorer &#8212; Neurophysiology Lab</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Responses" href="Responses_computational-model.html" />
    <link rel="prev" title="Lab Manual" href="Lab-Manual_computational-model.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/NeuronImage_CourseHeader.jpeg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Neurophysiology Lab</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to Neurophysiology Lab
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  General
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../standards.html">
   Standards
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../howto/howto.html">
   How To Guides
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/Python-Introduction-Coding-Light.html">
     Introduction to Python Notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/Executable-Notebooks.html">
     Executable Notebooks (Data Explorers)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/Response-Notebooks.html">
     Response Notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/Dash-Data-Explorer.html">
     Dash Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/NiUSB-6211.html">
     Nidaq USB 6211
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/getting-preamp.html">
     Getting Intracellular Amplifier
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/stimulus-isolation-unit.html">
     Stimulus Isolation Units
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/ground.html">
     Ground
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/exponential-decay.html">
     Exponential Decay
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/electrode-geometry.html">
     Electrode Geometry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/cap.html">
     Complex Action Potentials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/electrical-circuit-analysis.html">
     Electrical Circuit Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../howto/crayfish-anatomy.html">
     Crayfish Anatomy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../fifth-hour.html">
   Fifth Hour
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../materials.html">
   Materials
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Weekly Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../passive-membrane-models/passive-membrane-models_landing.html">
   Week 1. Introduction to Passive Physiology Principles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../passive-membrane-models/Lab-Manual_passive-membrane-models.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../passive-membrane-models/Responses_passive-membrane-models.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../eod/eod_landing.html">
   Week 2. Electric Organ Discharge
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../eod/Lab-Manual_eod.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eod/Data-Explorer_eod.html">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eod/Responses_eod.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../earthworm-giant-fiber-cap/earthworm-giant-fiber-cap_landing.html">
   Week 3. Giant Fiber - CAP
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-cap/Lab-Manual_earthworm-giant-fiber-cap.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-cap/Data-Explorer_earthworm-giant-fiber-cap.html">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-cap/Responses_earthworm-giant-fiber-cap.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../earthworm-giant-fiber-cv/earthworm-giant-fiber-cv_landing.html">
   Week 4. Giant Fiber - Conduction Velocity
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-cv/Lab-Manual_earthworm-giant-fiber-cv.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-cv/Data-Explorer_earthworm-giant-fiber-cv.html">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-cv/Responses_earthworm-giant-fiber-cv.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../earthworm-giant-fiber-surgery/earthworm-giant-fiber-surgery_landing.html">
   Week 5. Giant Fiber - AP - Surgery
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-surgery/Lab-Manual_earthworm-giant-fiber-surgery.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-surgery/Data-Explorer_earthworm-giant-fiber-surgery.html">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-surgery/Responses_earthworm-giant-fiber-surgery.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="computational-model_landing.html">
   Week 6. Computational Models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Lab-Manual_computational-model.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Responses_computational-model.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../earthworm-giant-fiber-ap/earthworm-giant-fiber-ap_landing.html">
   Week 7. Giant Fiber - AP
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-ap/Lab-Manual_earthworm-giant-fiber-ap.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-ap/Data-Explorer_earthworm-giant-fiber-ap.html">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../earthworm-giant-fiber-ap/Responses_earthworm-giant-fiber-ap.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../crayfish-mro/crayfish-mro_landing.html">
   Week 8. Muscle Receptor Organ
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-mro/Lab-Manual_crayfish-mro.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-mro/Data-Explorer_crayfish-mro.html">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-mro/Responses_crayfish-mro.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../crayfish-erg/crayfish-erg_landing.html">
   Week 9. ElectroRetinoGram
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-erg/Lab-Manual_crayfish-erg.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-erg/Data-Explorer_crayfish-erg.html">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-erg/Responses_crayfish-erg.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../crayfish-synaptic-connectivity/crayfish-synaptic-connectivity_landing.html">
   Week 10-11. Synaptic Connectivity
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-synaptic-connectivity/Lab-Manual_crayfish-synaptic-connectivity.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-synaptic-connectivity/Data-Explorer_crayfish-synaptic-connectivity.html">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-synaptic-connectivity/Responses_crayfish-synaptic-connectivity.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../human-bci-music/human-bci-music_landing.html">
   Week 12. Human Motor Neuron Coding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../human-bci-music/Lab-Manual_human-bci-music.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../human-bci-music/Data-Explorer_EMG-basics.html">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../human-bci-music/Responses_EMG-basics.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../capstone/capstone_landing.html">
   Week 13. Capstone
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../capstone/capstone_assignment-guidelines.html">
     Capstone guidelines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../capstone/Data-Explorer_ExcitabilityModel.html">
     Charlotte - Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../capstone/Data-Explorer_crayfish-superficial-flexor_pharmacology.html">
     Duncan - Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../capstone/Data-Explorer_human-emg-tens.html">
     Alexis - Data Explorer
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Future Directions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../extensions/extensions.html">
   Extended materials
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Back Burner
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cockroach-mechanoreceptor/cockroach-mechanoreceptor_landing.html">
   Mechanoreceptors
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../cockroach-mechanoreceptor/Lab-Manual_cockroach-mechanoreceptor.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cockroach-mechanoreceptor/Data-Explorer_cockroach-mechanoreceptor.html">
     Sensory Coding: Cockroach mechanoreceptors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cockroach-mechanoreceptor/Responses_cockroach-mechanoreceptor.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../crayfish-cpg/crayfish-cpg_landing.html">
   Neural Circuits CPG
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-cpg/Lab-Manual_crayfish-cpg.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-cpg/Data-Explorer_crayfish-cpg.html">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-cpg/Responses_crayfish-cpg.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../crayfish-synaptic-plasticity/crayfish-synaptic-plasticity_landing.html">
   Crayfish Synaptic Plasticity
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-synaptic-plasticity/Lab-Manual_crayfish-synaptic-plasticity.html">
     Lab Manual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-synaptic-plasticity/Data-Explorer_crayfish-synaptic-plasticity.html">
     Data Explorer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../crayfish-synaptic-plasticity/Responses_crayfish-synaptic-plasticity.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/modules/computational-model/Data-Explorer_computational-model.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/neurologic/Neurophysiology-Lab"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/neurologic/Neurophysiology-Lab/issues/new?title=Issue%20on%20page%20%2Fmodules/computational-model/Data-Explorer_computational-model.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/neurologic/Neurophysiology-Lab/main?urlpath=tree/modules/computational-model/Data-Explorer_computational-model.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/neurologic/Neurophysiology-Lab/blob/main/modules/computational-model/Data-Explorer_computational-model.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Data Explorer
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computer-models">
   Computer Models
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computer-implementation-of-computational-models">
   Computer implementation of computational models
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#steady-state-model">
   Steady State Model
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-simulation-1-steady-state-membrane-potential-model">
     Interactive Simulation 1: Steady-State Membrane Potential Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dynamic-model">
   Dynamic Model
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-simulation-2-dynamic-membrane-potential-model">
     Interactive Simulation 2: Dynamic Membrane Potential Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spiking">
   Spiking
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-simulation-3-lif-model-neuron">
     Interactive Simulation 3: LIF model neuron
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-simulation-4-lif-model-neuron">
     Interactive Simulation 4: LIF model neuron
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#strength-duration-tuning">
   Strength-Duration Tuning
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-fit-and-plot-strength-duration-threshold-data">
     Read, fit, and plot strength-duration threshold data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-strength-duration-tuning-across-neurons">
     Compare strength-duration tuning across neurons
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Data Explorer</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Data Explorer
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computer-models">
   Computer Models
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computer-implementation-of-computational-models">
   Computer implementation of computational models
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#steady-state-model">
   Steady State Model
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-simulation-1-steady-state-membrane-potential-model">
     Interactive Simulation 1: Steady-State Membrane Potential Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dynamic-model">
   Dynamic Model
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-simulation-2-dynamic-membrane-potential-model">
     Interactive Simulation 2: Dynamic Membrane Potential Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spiking">
   Spiking
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-simulation-3-lif-model-neuron">
     Interactive Simulation 3: LIF model neuron
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-simulation-4-lif-model-neuron">
     Interactive Simulation 4: LIF model neuron
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#strength-duration-tuning">
   Strength-Duration Tuning
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-fit-and-plot-strength-duration-threshold-data">
     Read, fit, and plot strength-duration threshold data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-strength-duration-tuning-across-neurons">
     Compare strength-duration tuning across neurons
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <p><a href="https://colab.research.google.com/github/neurologic/Neurophysiology-Lab/blob/main/modules/computational-model/Data-Explorer_computational-model.ipynb" target="_blank" rel="noopener noreferrer"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a></p>
<div class="tex2jax_ignore mathjax_ignore section" id="data-explorer">
<h1>Data Explorer<a class="headerlink" href="#data-explorer" title="Permalink to this headline">¶</a></h1>
<p><a id="toc"></a></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="#intro">Introduction</a></p></li>
<li><p><a class="reference external" href="#setup">Setup</a></p></li>
<li><p><a class="reference external" href="#function">Computer implementation of computational models</a></p></li>
<li><p><a class="reference external" href="#steady-state">Steady State Model</a></p></li>
<li><p><a class="reference external" href="#dynamic-model">Dynamic Model</a></p></li>
</ul>
<p><a id="intro"></a></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="computer-models">
<h1>Computer Models<a class="headerlink" href="#computer-models" title="Permalink to this headline">¶</a></h1>
<p>Modelling passive and active properties of neurons based on electric circuit models from Week 1.</p>
<p><a id="setup"></a></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="#toc">toc</a></p>
<p>Import and define functions</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title {display-mode: &quot;form&quot;}</span>

<span class="c1">#@markdown Run this code cell to import packages and define functions </span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span><span class="n">timezone</span><span class="p">,</span><span class="n">timedelta</span>
<span class="n">pal</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">n_colors</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">pal</span> <span class="o">=</span> <span class="n">pal</span><span class="o">.</span><span class="n">as_hex</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">HBox</span><span class="p">,</span> <span class="n">VBox</span><span class="p">,</span> <span class="n">widgets</span><span class="p">,</span> <span class="n">interact</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span> <span class="c1"># interactive display</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span><span class="n">timezone</span><span class="p">,</span><span class="n">timedelta</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
<span class="c1"># use NMA plot style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/nma.mplstyle&quot;</span><span class="p">)</span>
<span class="n">my_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">hyper_fit</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">r</span> <span class="o">+</span> <span class="p">((</span><span class="n">r</span><span class="o">*</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="n">t</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Task completed at &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="p">(</span><span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">5</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
</div>
<p><a id="functions"></a></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="computer-implementation-of-computational-models">
<h1>Computer implementation of computational models<a class="headerlink" href="#computer-implementation-of-computational-models" title="Permalink to this headline">¶</a></h1>
<p>To implement this computational model in computer code, you need to <em>define</em> a <em><strong>function</strong></em>.</p>
<p>A <em><strong>function</strong></em> in computer programming is <em>executable</em> code (it will do things when you “run” it). Functions <em>take</em> information that they need to do what they need to do.</p>
<p>As an analogy, your computational model is a function (an equation in this case). You <em>executed</em> that function when you were given values for ion equilibrium potential and resistance of a neuron and calculated the neuron’s resting membrane potential.</p>
<p>To define a function in python so that the computer can execute it, we need to write down instructions in a specific way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">function_name</span><span class="p">(</span> <span class="n">parameters</span> <span class="p">):</span>
   <span class="n">variable</span> <span class="o">=</span> <span class="n">equation</span>
   <span class="k">return</span> <span class="p">[</span><span class="n">variable</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>def</strong> indicates that we are defining a function</p></li>
<li><p><strong>function_name</strong> is the name we give the function</p></li>
<li><p>in parentheses after the function name, we list the information that will be provided to the function when it is executed (these are info that will be needed to do what we want the function to do… in this case calculate the resting membrane potential of a neuron)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:</span></code> transitions the code into the instructions for the function to follow when it is executed</p></li>
<li><p>the instructions for the function to execute are on the rest of the written lines, with each line indented</p></li>
<li><p><strong>return</strong> terminates the function and provides information that can be accessed after the function executes</p></li>
</ul>
<p>Let’s consider a basic function that calculates the square of a number (the number times itself).<br />
Examine the contents of the following code cell and then <em>run</em> the code cell to execute the definition of the function (this step actually creates the function that is defined with the text)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="c1"># this sets the name of the function and any variables that it will use</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="c1"># this is the equation that this function uses to transform &#39;x&#39; input into &#39;result&#39; output</span>
    <span class="k">return</span> <span class="n">result</span> <span class="c1"># this line makes the variable &#39;result&#39; available as an output of the function</span>
</pre></div>
</div>
</div>
</div>
<p>Nothing obvious will happen when you run a code cell that defines a function (other than an indication that the code cell ran). But… you can now use the function that you defined.<br />
In the code cell below, assign a number to the varable <code class="docutils literal notranslate"><span class="pre">my_number</span></code>. Then, run the code cell to execute that variable assignment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_number</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Now, in the next code cell, we will execute that function by typing the name of the function followed by parentheses containing the variable <em>my_number</em> (to provide the function with that information).<br />
Examine the code cell below and then run it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">square</span><span class="p">(</span><span class="n">my_number</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The function executes and returns the result of the instructions that it followed. In this case, the result is printed below the code cell, but can be assigned to another variable name by typing <code class="docutils literal notranslate"><span class="pre">result</span> <span class="pre">=</span> <span class="pre">square(my_number)</span></code>.</p>
<p><a id="steady-state"></a></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="steady-state-model">
<h1>Steady State Model<a class="headerlink" href="#steady-state-model" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="#toc">toc</a></p>
<p>You created a computational model of the steady state membrane potential that depends on the equilibrium potential and resistance of two ion conductances. To implement this computational model in computer code, you need to <em>define a function</em> that computes Vin based on your computational model equation. In the following code cell, replace <code class="docutils literal notranslate"><span class="pre">...</span></code> with the equation from your computational model that defines <span class="math notranslate nohighlight">\(V_{in}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the function</span>

<span class="k">def</span> <span class="nf">simulate_Vin_steady_state</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">R2</span><span class="p">):</span>
    
    <span class="n">Vin</span> <span class="o">=</span> <span class="o">...</span> 
    
    <span class="k">return</span> <span class="n">Vin</span>
</pre></div>
</div>
</div>
</div>
<details>
<summary> <font color='blue'>Click here for solution </font></summary>
<p>#define the function</p>
<p>def simulate_Vin_steady_state(E1,R1,E2,R2):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Vin = ... #( (E1/R1) + (E2/R2) ) / ( (1/R1) + (1/R2) )

return Vin
</pre></div>
</div>
</details>
<br>
<p>In the code cell below, assign the values that you used in your circuit membrane model (<a href="https://colab.research.google.com/github/neurologic/Neurophysiology-Lab/blob/main/modules/passive-membrane-models/Lab-Manual_passive-membrane-models.ipynb" target="_blank" rel="noopener noreferrer">Passive Membrane Properties lab: Part I</a>) to each variable needed by the function. Then, run the code cell to assign those values to the variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">R2</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">E1</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">E2</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<p>Now, examine the contents of the code cell below and replace the <code class="docutils literal notranslate"><span class="pre">...</span></code> with the model parameters you just defined (separated by commas). Then run the code cell to simulate your computational model given the values you just provided. Note that the order of information provided to the function matters - it must match the order you defined when defining the function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulate_Vin_steady_state</span><span class="p">(</span> <span class="o">...</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<details>
<summary> <font color='blue'>Click here for solution </font></summary>
<p>simulate_Vin_steady_state(E1,R1,E2,R2)</p>
</details>
<br>
<p>How do the results of your computational model compare to your manually measured electric circuit model results from that lab?</p>
<div class="section" id="interactive-simulation-1-steady-state-membrane-potential-model">
<h2>Interactive Simulation 1: Steady-State Membrane Potential Model<a class="headerlink" href="#interactive-simulation-1-steady-state-membrane-potential-model" title="Permalink to this headline">¶</a></h2>
<p>Let’s implement your computational model into a more interactive simulation that you can use to efficiently explore the predictions of your model. There is more to learn about computer programming in Python than we will cover here to be able to make a more interactive simulation, so I have done the coding for you. But you can click <code class="docutils literal notranslate"><span class="pre">Show</span> <span class="pre">Code</span></code> if you want to take a look if you want.</p>
<p>Run the code cell below to run the interactive simulation. Toggle the sliders to explore the behavior of the model across the parameter space.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title {display-mode: &#39;form&#39;}</span>

<span class="c1">#@markdown Run this code cell to generate an interactive widget using the scripted </span>
<span class="c1">#@markdown implementation (of your passive membrane model) that you just created. &lt;br&gt;</span>
<span class="c1">#@markdown The results of the simulation (given the selected paramaters) is printed on the top line.</span>
<span class="c1">#@markdown (note that parameter selection actually happens when you release the mouse click from the slider).</span>


<span class="n">slider_E1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;E1 (mV)&#39;</span><span class="p">)</span>
<span class="n">slider_E1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;600px&#39;</span>

<span class="n">slider_R1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;R1 (MOhm)&#39;</span><span class="p">)</span>
<span class="n">slider_R1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;600px&#39;</span>

<span class="n">slider_E2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;E2 (mV)&#39;</span><span class="p">)</span>
<span class="n">slider_E2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;600px&#39;</span>

<span class="n">slider_R2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;R2 (MOhm)&#39;</span><span class="p">)</span>
<span class="n">slider_R2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;600px&#39;</span>

<span class="n">label_result</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s1">&#39;The resting membrane potential of the neuron will be: &#39;</span>
<span class="p">)</span>
<span class="n">label_result</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;600px&#39;</span>
<span class="n">display</span><span class="p">(</span><span class="n">label_result</span><span class="p">)</span>


<span class="c1"># a function that will modify the xaxis range</span>
<span class="k">def</span> <span class="nf">update_result</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">R2</span><span class="p">):</span>
    <span class="n">Vin</span> <span class="o">=</span> <span class="n">simulate_Vin_steady_state</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">R2</span><span class="p">)</span>
    <span class="n">label_result</span><span class="o">.</span><span class="n">value</span><span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;The resting membrane potential of the neuron will be: </span><span class="si">{</span><span class="n">Vin</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> mV&#39;</span>

<span class="n">w</span> <span class="o">=</span> <span class="n">interact</span><span class="p">(</span><span class="n">update_result</span><span class="p">,</span> <span class="n">E1</span><span class="o">=</span><span class="n">slider_E1</span><span class="p">,</span><span class="n">R1</span> <span class="o">=</span> <span class="n">slider_R1</span><span class="p">,</span><span class="n">E2</span><span class="o">=</span><span class="n">slider_E2</span><span class="p">,</span><span class="n">R2</span><span class="o">=</span><span class="n">slider_R2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p><a id="dynamic-model"></a></p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="dynamic-model">
<h1>Dynamic Model<a class="headerlink" href="#dynamic-model" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="#toc">toc</a></p>
<p>The dynamic computatinoal model that we formulated in class is a differential equation. We can simulate a differential equation by iterating through each time step across an array of time.</p>
<p>Remember that your computational model is in a format useful for calculating the change in voltage (<span class="math notranslate nohighlight">\(\partial{V}\)</span>) across some duration of time:</p>
<div class="math notranslate nohighlight">
\[
\partial{V} = (Iapp - \frac{V-E}{R}) * (\frac{\partial{t}}{C})
\]</div>
<p>where <span class="math notranslate nohighlight">\(Iapp\)</span> is the current applied across the membrane, <span class="math notranslate nohighlight">\(V\)</span> is the current membrane potential (<span class="math notranslate nohighlight">\(V_{in}\)</span>), <span class="math notranslate nohighlight">\(E\)</span> is the net equilibrium potential of the membrane at that moment in time, <span class="math notranslate nohighlight">\(R\)</span> is the net resistance of the membrane at that moment in time, and <span class="math notranslate nohighlight">\(C\)</span> is the membrane capacitance. This equation can be <em>evaluated</em> over any value of <span class="math notranslate nohighlight">\(\partial{t}\)</span>.</p>
<p>Now let’s look at how to script a function that iterates through sequential time steps and uses the computational model to determine the membrane potential of the neuron at each time step. In this way, the script defines a function that will implements a simulation of the computational model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simulate_Vin_dynamic</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Iapp</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The simulation starts at time = 0 with the voltage given by the input to the function (V)</span>
<span class="sd">    E = the equilibrium potential of the net ionic conductance</span>
<span class="sd">    </span>
<span class="sd">    R = the resistance of the membrane in Ohm</span>
<span class="sd">    </span>
<span class="sd">    C = the capacitance of the membrane in Farads</span>
<span class="sd">    </span>
<span class="sd">    Iapp = the current (microAmps) applied to the system throughout the simulation</span>
<span class="sd">    </span>
<span class="sd">    duration = the total time (seconds) that the current is applied to the system (in this case also the duration of the simulation)</span>
<span class="sd">    </span>
<span class="sd">    dt = the time step (seconds) for analysing the simulation (how much time elapses between each analysis of dV)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">timesteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
    
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    we will just use the equilibrium membrane potential of the neuron </span>
<span class="sd">    as the initial membrane potential </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">V_record</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="p">]</span> <span class="c1"># initialize an array of membrane potential across time with the initial membrane potential</span>
    
    <span class="sd">&#39;&#39;&#39; then, we will iterate through time using a &quot;for loop&quot; &#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">timesteps</span><span class="p">):</span> <span class="c1"># for each time step, iterate through the simulation</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">V_record</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># what is the current membrane potential?</span>
        <span class="n">dV</span> <span class="o">=</span> <span class="p">(</span><span class="n">Iapp</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">R</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">V</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="n">C</span><span class="p">)</span> <span class="c1"># how much does the voltage change by on this time step?</span>
        <span class="n">V</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span><span class="o">+</span><span class="n">dV</span><span class="p">)</span> <span class="c1"># add the change in voltage to the current voltage</span>
        <span class="n">V_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="c1"># append the new voltage to the array of membrane voltage across time. </span>
    
    <span class="k">return</span> <span class="n">V_record</span> <span class="c1"># make the array &quot;V_record&quot; available as an output of the scripted function</span>

<span class="c1"># Make sure to &quot;run&quot; this code cell before moving on, </span>
<span class="c1"># so that the function &quot;simulate_Vin_dynamic&quot; can be used by later code cells.</span>
</pre></div>
</div>
</div>
</div>
<p>To run a simulation of the model, we need to define: 1) the initial conditions of the membrane, and 2) the amplitude of the applied current.</p>
<p>Before using the scripted version of your computational model to simulate the membrane potential response to an applied current, it is helpful to manually calculate the response for just a few timesteps after a current is applied.</p>
<blockquote>
<div><p>Use the following initial conditions: E = -60 millivolts, R = 100 MOhm, C = 100 pF. Apply a 100 pA current across the membrane.</p>
</div></blockquote>
<p><strong>Time Step 1</strong></p>
<ol>
<li><p>What is the inital value of <span class="math notranslate nohighlight">\(V_{in}\)</span>?</p>
<blockquote>
<div><p>This is the value of <span class="math notranslate nohighlight">\(V_{in}\)</span> at the moment when the current is applied.</p>
</div></blockquote>
</li>
<li><p>At the first time step, what is the value of (<span class="math notranslate nohighlight">\(\partial{V}\)</span>)?</p></li>
<li><p>Update <span class="math notranslate nohighlight">\(V_{in}\)</span> according to the initial <span class="math notranslate nohighlight">\(V_{in}\)</span> + (<span class="math notranslate nohighlight">\(\partial{V}\)</span>) on the first time step.</p></li>
</ol>
<p><strong>Time Step 2</strong></p>
<ol>
<li><p>What is the initial value of <span class="math notranslate nohighlight">\(V_{in}\)</span> on this time step?</p></li>
<li><p>At this time step, what is the value of (<span class="math notranslate nohighlight">\(\partial{V}\)</span>)?</p></li>
<li><p>WHY is the value of (<span class="math notranslate nohighlight">\(\partial{V}\)</span>) different for this time step versus the last time step?</p>
<blockquote>
<div><p>Note there are several ways to address <em>why</em>. There is an answer in terms of the value of <span class="math notranslate nohighlight">\(V_{in}\)</span>. There is also an answer in terms of the current accross the capacitor. Remember, voltage across a capacitor only changes when there is current across the capacitor (and the magnitude of the voltage change is proportional to the amount of current).</p>
</div></blockquote>
</li>
<li><p>Update <span class="math notranslate nohighlight">\(V_{in}\)</span> according to the inital <span class="math notranslate nohighlight">\(V_{in}\)</span> + (<span class="math notranslate nohighlight">\(\partial{V}\)</span>) on the first time step.</p></li>
</ol>
<p><strong>Time Step 3</strong><br />
<em>Repeat the steps for time step 2 and notice how/why (<span class="math notranslate nohighlight">\(\partial{V}\)</span>) changes again on this time step compared to the first two time steps.</em></p>
<p>In the code cell below, we are defining the net equilibrium potential of the resting membrane conductances (<span class="math notranslate nohighlight">\(E\)</span>), the net resistance across the membrane (<span class="math notranslate nohighlight">\(R\)</span>), and the capacitance of the membrane (<span class="math notranslate nohighlight">\(C\)</span>). We are then defining the magnitude of the applied current (<span class="math notranslate nohighlight">\(Iapp\)</span>). We will also specify a duration for the square pulse stimulus (in this case equal to the duration of our simulation).</p>
<p>Importantly, we need to set a timestep value (<span class="math notranslate nohighlight">\(\partial{t}\)</span>) the time between iterations of the simulation across time).</p>
<p>After all of the variables required by the scripted function are defined, the script run a simulation of the computational model.</p>
<p>After you run the code cell below, you will see a plot of the simulated membrane potential across time in response to the applied square-wave current step. The calculated <span class="math notranslate nohighlight">\(\tau\)</span> for the model membrane will be printed above the plot.</p>
<p>What happens when you increase or decrease the value of <span class="math notranslate nohighlight">\(\partial{t}\)</span>? (try it out)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the initial conditions</span>
<span class="n">E</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c1"># millivolts</span>
<span class="n">R</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="mf">1e6</span> <span class="c1"># MOhm</span>
<span class="n">C</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="mf">1e-12</span> <span class="c1"># pF</span>

<span class="n">Iapp</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="mf">1e-12</span> <span class="c1">#pA  </span>
<span class="n">duration</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c1">#msec</span>

<span class="sd">&#39;&#39;&#39; </span>
<span class="sd">Now we run the simulation</span>
<span class="sd">- V_record is the output of the function (the array of membrane potential values across time steps)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="n">V_record</span> <span class="o">=</span> <span class="n">simulate_Vin_dynamic</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Iapp</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="sd">&#39;&#39;&#39; </span>
<span class="sd">Now we plot the results of the simulation (and label the axes)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="n">hfig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">duration</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">duration</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">V_record</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;seconds&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Volts&#39;</span><span class="p">);</span>

<span class="sd">&#39;&#39;&#39; </span>
<span class="sd">Finally, we can calculate the time constant of this model membrane and print the value above the figure</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tau = </span><span class="si">{</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">C</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1"> seconds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="interactive-simulation-2-dynamic-membrane-potential-model">
<h2>Interactive Simulation 2: Dynamic Membrane Potential Model<a class="headerlink" href="#interactive-simulation-2-dynamic-membrane-potential-model" title="Permalink to this headline">¶</a></h2>
<p>Let’s implement your computational model into a more interactive simulation that you can use to efficiently explore predictions of your model.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title {display-mode: &quot;form&quot;}</span>

<span class="c1">#@markdown Run this code cell to genrate an interactive widget using the model you just created.  &lt;br&gt;</span>
<span class="c1">#@markdown The stimulus is a square-wave current pulse starting at t=0 with a duration of 1 second</span>

<span class="c1"># set up the applied current</span>
<span class="n">delay</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1">#seconds</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#seconds</span>

<span class="c1"># define the simulation conditions</span>
<span class="n">total_duration</span> <span class="o">=</span> <span class="mf">1.2</span> <span class="c1">#seconds</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.00001</span> <span class="c1">#seconds</span>

<span class="c1"># Create sliders for the figure widget inputs</span>
<span class="n">E_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Equilibrium Potential (mV)&#39;</span><span class="p">,</span>
    <span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;200px&#39;</span><span class="p">})</span>
<span class="n">E_slider</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;600px&#39;</span>

<span class="n">R_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;R (MOhm)&#39;</span><span class="p">)</span>
<span class="n">R_slider</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;600px&#39;</span>

<span class="n">C_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span>
    <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">readout_format</span><span class="o">=</span><span class="s1">&#39;.3f&#39;</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;C (nF)&#39;</span><span class="p">)</span>
<span class="n">C_slider</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;600px&#39;</span>

<span class="n">thresh_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Relative Spike Threshold (mV)&#39;</span><span class="p">,</span>
    <span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;200px&#39;</span><span class="p">})</span>
<span class="n">thresh_slider</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;600px&#39;</span>

<span class="n">amplitude_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=-</span><span class="mi">500</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;I (pA)&#39;</span><span class="p">)</span>
<span class="n">amplitude_slider</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;600px&#39;</span>

<span class="n">label_tau</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s1">&#39;tau = &#39;</span>
<span class="p">)</span>
<span class="n">label_tau</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;600px&#39;</span>
<span class="n">display</span><span class="p">(</span><span class="n">label_tau</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update_plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">thresh</span><span class="p">,</span><span class="n">amplitude</span><span class="p">):</span><span class="c1"># set up the simulation items</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c1"># convert from millivolts to volts</span>
    <span class="c1"># V = E # start the simulation at equilibrium</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="mf">1e6</span> <span class="c1"># convert from MegaOhm to Ohm</span>
    <span class="c1"># tau = tau*1e-3 # convert from milliseconds to seconds</span>
    <span class="n">amplitude</span> <span class="o">=</span> <span class="n">amplitude</span><span class="o">*</span><span class="mf">1e-12</span> <span class="c1"># Convert from picoAmps to Amps</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">C</span><span class="o">*</span><span class="mf">1e-9</span> <span class="c1"># convert from microfarad to farad</span>
    
    <span class="c1"># print(R,tau,C,amplitude)   </span>
    
    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">total_duration</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">total_duration</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">delay</span>
    <span class="n">stimulus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">total_duration</span><span class="o">/</span><span class="n">dt</span><span class="p">)))</span>
    <span class="n">stimulus</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">delay</span><span class="o">/</span><span class="n">dt</span><span class="p">):</span><span class="nb">int</span><span class="p">((</span><span class="n">delay</span><span class="o">+</span><span class="n">duration</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)]</span><span class="o">=</span><span class="n">amplitude</span>
    <span class="n">V_record</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">total_duration</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

    <span class="c1"># write the &quot;for&quot; loop</span>
    <span class="c1"># simulate_V(E, R, C, Iapp, duration, dt)</span>
<span class="c1">#     for i,current in enumerate(stimulus):</span>
<span class="c1">#         dV = dt*((current - (V-E)/R)/C)</span>
<span class="c1">#         V = (V+dV) </span>
<span class="c1">#         V_record[i]=V</span>
        
    <span class="n">V_record</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">E</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">Iapp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stimulus</span><span class="p">):</span> <span class="c1"># for each time step, iterate through the simulation</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">V_record</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">dV</span> <span class="o">=</span> <span class="p">(</span><span class="n">Iapp</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">R</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">V</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="n">C</span><span class="p">)</span> <span class="c1"># how much does the voltage change by on this time step?</span>
        <span class="n">V</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span><span class="o">+</span><span class="n">dV</span><span class="p">)</span> <span class="c1"># add the change in voltage to the current voltage</span>
        <span class="n">V_record</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">V</span>
    
<span class="c1">#     V_record = [V_initial]</span>
<span class="c1"># for i in range(timesteps): # for each time step, iterate through the simulation</span>
<span class="c1">#     V = V_record[-1]</span>
<span class="c1">#     dV = (Iapp - (1/R)*(V-0))*(dt/C) # how much does the voltage change by on this time step?</span>
<span class="c1">#     V = (V+dV) # add the change in voltage to the current voltage</span>
<span class="c1">#     V_record.append(V)</span>
  
    <span class="c1"># return V_record</span>

    <span class="n">hfig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="c1"># add simulation vectors to the figure widget</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">V_record</span><span class="o">*</span><span class="mf">1e3</span><span class="p">)</span> <span class="c1"># convert from Volts to milliVolts</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">((</span><span class="n">V_record</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">thresh</span><span class="p">),</span> <span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;seconds&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;mV&#39;</span><span class="p">)</span>
    
    <span class="n">label_tau</span><span class="o">.</span><span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;tau = </span><span class="si">{</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">C</span><span class="p">)</span><span class="si">:</span><span class="s1">0.4f</span><span class="si">}</span><span class="s1"> seconds&#39;</span>


<span class="n">w</span> <span class="o">=</span> <span class="n">interact</span><span class="p">(</span><span class="n">update_plot</span><span class="p">,</span>
             <span class="n">E</span><span class="o">=</span><span class="n">E_slider</span><span class="p">,</span>
             <span class="n">R</span><span class="o">=</span><span class="n">R_slider</span><span class="p">,</span> 
             <span class="n">C</span><span class="o">=</span><span class="n">C_slider</span><span class="p">,</span>
             <span class="n">thresh</span><span class="o">=</span><span class="n">thresh_slider</span><span class="p">,</span>
             <span class="n">amplitude</span><span class="o">=</span><span class="n">amplitude_slider</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Note that <span class="math notranslate nohighlight">\( 1mV = 100pA * 10MOhm \)</span>. Why would you want to measure and report in terms of these units and not V, A, Ohm?</p>
<p><a id="three"></a></p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="spiking">
<h1>Spiking<a class="headerlink" href="#spiking" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="#toc">toc</a></p>
<p>Simulating spiking output of your model membrane does not require mathematically solving for the voltage-gated conductances. Many computational models of neuron spiking activity simply use knowledge about spike thresholds and refractory periods to implement <em><strong>conditional statements</strong></em> in the model that simulate spikes. These are often called <em>Leaky Integrate and Fire</em> models (<em><strong>LIF</strong></em>).</p>
<p>The following gives a hybrid english-python description of the implementation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spike_treshold</span> <span class="o">=</span> <span class="n">x</span> <span class="p">(</span><span class="ow">in</span> <span class="n">mV</span><span class="p">)</span>
<span class="n">spike_amplitude</span> <span class="o">=</span> <span class="n">x</span> <span class="p">(</span><span class="ow">in</span> <span class="n">mV</span><span class="p">)</span>
<span class="n">spike_refractory</span> <span class="o">=</span> <span class="n">x</span> <span class="p">(</span><span class="ow">in</span> <span class="n">ms</span><span class="p">)</span>
<span class="n">after_hyperpolarization</span> <span class="o">=</span> <span class="n">x</span> <span class="p">(</span><span class="ow">in</span> <span class="n">mV</span><span class="p">)</span>

<span class="n">start</span> <span class="n">at</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">x</span> <span class="p">(</span><span class="ow">in</span> <span class="n">ms</span><span class="p">)</span>
<span class="n">V</span><span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">Equilibrium</span> <span class="n">Potential</span>

<span class="n">repeat</span> <span class="n">the</span> <span class="n">following</span> <span class="n">steps</span> <span class="n">until</span> <span class="n">the</span> <span class="n">end</span> <span class="n">of</span> <span class="n">time</span> <span class="ow">is</span> <span class="n">reached</span><span class="p">:</span>
    <span class="n">Determine</span> <span class="n">the</span> <span class="n">current</span> <span class="n">membrane</span> <span class="n">potential</span>
    <span class="o">&gt;</span> <span class="n">Vinitial</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="n">If</span> <span class="n">the</span> <span class="n">current</span> <span class="n">membrane</span> <span class="n">potential</span> <span class="ow">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="ow">or</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">spike_treshold</span><span class="p">:</span>
        <span class="n">Instead</span> <span class="n">of</span> <span class="n">calculating</span> <span class="n">dV</span> <span class="k">for</span> <span class="n">this</span> <span class="n">timestep</span><span class="p">,</span> 
        <span class="nb">set</span> <span class="n">the</span> <span class="n">voltage</span> <span class="n">at</span> <span class="n">the</span> <span class="nb">next</span> <span class="n">timestep</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">the</span> <span class="n">amplitude</span> <span class="n">of</span> <span class="n">a</span> <span class="n">spike</span> 
        <span class="o">&gt;</span> <span class="n">V</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span> <span class="o">=</span> <span class="n">spike_amplitude</span>
    
        <span class="n">Move</span> <span class="n">on</span> <span class="n">to</span> <span class="n">the</span> <span class="nb">next</span> <span class="n">time</span> <span class="n">step</span> <span class="n">after</span> <span class="n">the</span> <span class="n">refractory</span> <span class="n">period</span> <span class="n">has</span> <span class="n">ended</span>
        <span class="o">&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">spike_refractory</span>
        <span class="n">Set</span> <span class="n">the</span> <span class="n">membrane</span> <span class="n">potential</span> <span class="n">at</span> <span class="n">this</span> <span class="n">time</span> <span class="n">to</span> <span class="n">the</span> <span class="n">after</span> <span class="n">hyperpolarization</span> <span class="n">value</span>
        <span class="o">&gt;</span> <span class="n">V</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">after_hyperpolarization</span>

    <span class="n">If</span> <span class="n">the</span> <span class="n">current</span> <span class="n">membrane</span> <span class="n">potential</span> <span class="ow">is</span> <span class="n">less</span> <span class="n">than</span> <span class="n">spike_treshold</span><span class="p">:</span>
        <span class="n">Calculate</span> <span class="n">dV</span> <span class="n">according</span> <span class="n">to</span> <span class="n">the</span> <span class="n">RC</span> <span class="n">circuit</span> <span class="n">model</span> <span class="n">of</span> <span class="n">the</span> <span class="n">membrane</span>
        <span class="n">Set</span> <span class="n">the</span> <span class="n">voltage</span> <span class="n">at</span> <span class="n">the</span> <span class="nb">next</span> <span class="n">timestep</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">Vinitial</span> <span class="o">+</span> <span class="n">dV</span>
        <span class="o">&gt;</span> <span class="n">V</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span> <span class="o">=</span> <span class="n">Vinitial</span> <span class="o">+</span> <span class="n">dV</span>

        <span class="n">Move</span> <span class="n">on</span> <span class="n">to</span> <span class="n">the</span> <span class="nb">next</span> <span class="n">time</span> <span class="n">step</span>
        <span class="o">&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">dt</span>
  

</pre></div>
</div>
<div class="section" id="interactive-simulation-3-lif-model-neuron">
<h2>Interactive Simulation 3: LIF model neuron<a class="headerlink" href="#interactive-simulation-3-lif-model-neuron" title="Permalink to this headline">¶</a></h2>
<p>This simulation incorporates “spiking” into your RC circuit model using conditional statements.
The stimulation protocol in the simulation is a 1 second duration (<em><strong>Long Square</strong></em>) current step.</p>
<p>Use this simulation to explore the relationships among membrane resistance, capacitance, equilibrium potential, spike threshold, and amplitude of an applied current.</p>
<p>Parameters are resported in the following units:</p>
<ul class="simple">
<li><p>Applied current : pA</p></li>
<li><p>Membrane Capacitance : nF</p></li>
<li><p>Membrane Resistance : MOhm</p></li>
<li><p>Membrane Potentials : mV</p></li>
</ul>
<blockquote>
<div><p>Note, that the units of membrane capacitance and resistance have been selected to make the calculation of the Time constant (in milliseconds) easy because: Tau (in ms) = C (in nF) * R (in MOhm)</p>
</div></blockquote>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title {display-mode: &quot;form&quot;}</span>

<span class="c1">#@markdown Run this cell to enable the interactive plot. </span>

<span class="k">def</span> <span class="nf">default_pars</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">pars</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># typical neuron parameters#</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_th&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">55.</span>     <span class="c1"># spike threshold [mV]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_reset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>  <span class="c1"># reset potential [mV]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>     <span class="c1"># membrane time constant [ms]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.500</span>        <span class="c1"># membrane capacitance [nF]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;R_L&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">50.</span>       <span class="c1"># leak Resistance [MOhm]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>   <span class="c1"># initial potential [mV]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;E_L&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>      <span class="c1"># leak reversal potential [mV]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>       <span class="c1"># refractory time (ms)</span>

    <span class="c1"># simulation parameters #</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1200.</span>  <span class="c1"># Total duration of simulation [ms]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.001</span>   <span class="c1"># Simulation time step [ms]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># delay from trial onset to stimulation start [ms]</span>

    <span class="c1"># external parameters if any #</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">])</span><span class="o">-</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span>  <span class="c1"># Vector of discretized time points [ms]</span>

    <span class="k">return</span> <span class="n">pars</span>

<span class="k">def</span> <span class="nf">plot_volt_trace</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot trajetory of membrane potential for a single neuron</span>

<span class="sd">    Expects:</span>
<span class="sd">    pars   : parameter dictionary</span>
<span class="sd">    v      : volt trajetory</span>
<span class="sd">    sp     : spike train</span>

<span class="sd">    Returns:</span>
<span class="sd">    figure of the membrane potential trajetory for a single neuron</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hfig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">V_th</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_th&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span>
    <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span>
    <span class="k">if</span> <span class="n">sp</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="n">sp_num</span> <span class="o">=</span> <span class="p">(</span><span class="n">sp</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">v</span><span class="p">[</span><span class="n">sp_num</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">40</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span>  <span class="c1"># draw nicer spikes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">range_t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">V_th</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="c1"># ax.set_xticks(fontsize=14)</span>
    <span class="c1"># ax.set_yticks(fontsize=14)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Membrane</span><span class="se">\n</span><span class="s1">potential&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Threshold V$_{\mathrm</span><span class="si">{th}</span><span class="s1">}$&#39;</span><span class="p">],</span>
             <span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.090</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.020</span><span class="p">])</span>

    
<span class="k">def</span> <span class="nf">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">Iinj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate the LIF dynamics with external input current</span>
<span class="sd">    Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    Iinj       : input current [pA]. The injected current here can be a value</span>
<span class="sd">                 or an array</span>
<span class="sd">    stop       : boolean. If True, use a current pulse</span>
<span class="sd">    Returns:</span>
<span class="sd">    rec_v      : membrane potential</span>
<span class="sd">    rec_sp     : spike times</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set parameters</span>
    <span class="n">V_th</span><span class="p">,</span> <span class="n">V_reset</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_th&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_reset&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span>  <span class="c1"># convert to V</span>
    <span class="n">R_L</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;R_L&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e6</span> <span class="c1">#convert to Ohm from MegaOhm</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-9</span> <span class="c1"># convert to Farad from nanoF</span>
    <span class="n">V_init</span><span class="p">,</span> <span class="n">E_L</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_init&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;E_L&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c1"># convert to V</span>
    <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c1"># convert to Sec</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span>
    <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>
    <span class="n">tref</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tref&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span>

    <span class="c1"># Initialize voltage</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_init</span>

    <span class="c1"># Set current time course</span>
    <span class="n">Iinj</span> <span class="o">=</span> <span class="p">(</span><span class="n">Iinj</span><span class="o">*</span><span class="mf">1e-12</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span> <span class="c1"># convert to Amp from picoamp</span>
    <span class="n">durstep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(((</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">fs</span><span class="p">))</span> <span class="c1"># hard code for now as 1 second.... was int(((durstep*1e-3)*fs)/2)</span>
    <span class="c1"># If current pulse, set beginning and end to 0</span>
    <span class="c1"># if stop: (for this one, just do a step</span>
    <span class="c1"># Iinj[:int(len(Iinj) / 2) - durstep] = 0</span>
    <span class="c1"># Iinj[int(len(Iinj) / 2) + durstep:] = 0</span>
    
    <span class="n">delay</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span><span class="o">*</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">Iinj</span><span class="p">[:</span><span class="n">delay</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Iinj[:int(len(Iinj) / 2) - durstep] = 0</span>
    <span class="n">Iinj</span><span class="p">[(</span><span class="n">delay</span><span class="o">+</span><span class="n">durstep</span><span class="p">):]</span><span class="o">=</span><span class="mi">0</span> 
    <span class="c1"># Iinj[int(len(Iinj) / 2) + durstep:] = 0</span>

    <span class="c1"># Loop over time</span>
    <span class="n">rec_spikes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># record spike times</span>
    <span class="n">tr</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># the count for refractory duration</span>

    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">tr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># check if in refractory period</span>
            <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>  <span class="c1"># set voltage to reset</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># reduce running counter of refractory period</span>

        <span class="k">elif</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">V_th</span><span class="p">:</span>  <span class="c1"># if voltage over threshold</span>
            <span class="n">rec_spikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>  <span class="c1"># record spike event</span>
            <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>  <span class="c1"># reset voltage</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">tref</span> <span class="o">/</span> <span class="n">dt</span>  <span class="c1"># set refractory time</span>

        <span class="c1"># Calculate the increment of the membrane potential</span>
        <span class="c1"># dv = (-(v[it] - E_L) + Iinj[it] / g_L) * (dt / tau_m)</span>
        <span class="n">dv</span> <span class="o">=</span> <span class="p">(</span><span class="n">Iinj</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="p">((</span><span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">E_L</span><span class="p">)</span><span class="o">/</span><span class="n">R_L</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="n">C</span><span class="p">)</span>

        <span class="c1"># Update the membrane potential</span>
        <span class="n">v</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">dv</span>

    <span class="c1"># Get spike times in ms</span>
    <span class="n">rec_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rec_spikes</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="k">return</span> <span class="n">v</span><span class="p">,</span> <span class="n">rec_spikes</span>



<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;700px&#39;</span>
<span class="c1"># my_layout.description_width = &#39;initial&#39;</span>
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">}</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">current_injection</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">50.</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">800.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span><span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="c1"># Simulation_Duration=widgets.FloatSlider(200., min=0.02, max=5., step=0.01,</span>
    <span class="c1">#                            layout=my_layout,style=style),</span>
    <span class="c1"># Injection_Step=widgets.Checkbox(value=True,</span>
    <span class="c1">#                            description=&#39;current step (vs continuous)&#39;,</span>
    <span class="c1">#                            layout=my_layout,style=style),</span>
    <span class="c1"># Current_Step_Duration=widgets.FloatSlider(100., min=0.01, max=1000., step=0.01,</span>
    <span class="c1">#                            layout=my_layout,style=style),</span>
    <span class="n">Equilibrium_Potential</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="o">-</span><span class="mf">75.</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="nb">max</span><span class="o">=-</span><span class="mf">30.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span><span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="n">Resistance</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">50.</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1000.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span><span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="c1"># AHP_Voltage=widgets.FloatSlider(-70., min=-100., max=-30.,step=1.,</span>
    <span class="c1">#                            layout=my_layout,style=style,continuous_update=False),</span>
    <span class="n">Spike_Threshold</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="o">-</span><span class="mf">55.</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">100.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=-</span><span class="mf">20.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span><span class="n">continuous_update</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Capacitance</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">0.200</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span><span class="n">readout_format</span><span class="o">=</span><span class="s1">&#39;.3f&#39;</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span><span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">diff_DC</span><span class="p">(</span><span class="n">current_injection</span><span class="p">,</span>
            <span class="c1"># Simulation_Duration,</span>
            <span class="c1"># Injection_Step,</span>
            <span class="c1"># Current_Step_Duration,</span>
            <span class="n">Equilibrium_Potential</span><span class="p">,</span>
            <span class="n">Resistance</span><span class="p">,</span>
            <span class="n">Capacitance</span><span class="p">,</span>
            <span class="c1"># AHP_Voltage,</span>
            <span class="n">Spike_Threshold</span><span class="p">):</span> <span class="c1">#I_dc=200., tau_m=10.):</span>
    <span class="c1"># pars = default_pars(T=100.)</span>
    <span class="c1"># pars[&#39;tau_m&#39;] = tau_m</span>
    <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span>
      <span class="n">E_L</span> <span class="o">=</span> <span class="n">Equilibrium_Potential</span><span class="p">,</span>
      <span class="n">R_L</span> <span class="o">=</span> <span class="n">Resistance</span><span class="p">,</span>
      <span class="n">V_init</span> <span class="o">=</span> <span class="n">Equilibrium_Potential</span><span class="p">,</span>
      <span class="n">V_reset</span> <span class="o">=</span> <span class="n">Spike_Threshold</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span>
      <span class="n">V_th</span> <span class="o">=</span> <span class="n">Spike_Threshold</span><span class="p">,</span>
      <span class="c1"># tau_m = Membrane_Tau,</span>
      <span class="n">C</span> <span class="o">=</span> <span class="n">Capacitance</span><span class="p">)</span> <span class="c1">#,</span>
      <span class="c1"># T = Simulation_Duration)</span>
    <span class="c1"># pars=default_pars()</span>
    <span class="n">v</span><span class="p">,</span> <span class="n">sp</span> <span class="o">=</span> <span class="n">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">Iinj</span><span class="o">=</span><span class="n">current_injection</span><span class="p">)</span> <span class="c1">#,stop=Injection_Step,durstep=Current_Step_Duration)</span>
    <span class="n">plot_volt_trace</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sp</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Interactive demo initiated at &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="p">(</span><span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">5</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="interactive-simulation-4-lif-model-neuron">
<h2>Interactive Simulation 4: LIF model neuron<a class="headerlink" href="#interactive-simulation-4-lif-model-neuron" title="Permalink to this headline">¶</a></h2>
<p>The stimulation protocol in the simulation is a 0.01-10 millisecond duration (<em><strong>Short Square</strong></em>) current step.</p>
<p>Use this simulation to perform a ‘strenght-duration’ stimulus threshold experiment on model neurons.</p>
<p>Parameters are reported in the following units:</p>
<ul class="simple">
<li><p>Applied current : nA (note that this is different from the Allen database and simulation 3)</p></li>
<li><p>Membrane Capacitance : nF</p></li>
<li><p>Membrane Resistance : MOhm</p></li>
<li><p>Membrane Potentials : mV</p></li>
</ul>
<blockquote>
<div><p>Note, that the units of membrane capacitance and resistance have been selected to make the calculation of the Time constant (in milliseconds) easy because: Tau (in ms) = C (in nF) * R (in MOhm)</p>
</div></blockquote>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title {display-mode: &quot;form&quot;}</span>

<span class="c1">#@markdown Run this cell to enable the interactive plot. </span>

<span class="k">def</span> <span class="nf">default_pars</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">pars</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># typical neuron parameters#</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_th&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">55.</span>     <span class="c1"># spike threshold [mV]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_reset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>  <span class="c1"># reset potential [mV]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tau_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>     <span class="c1"># membrane time constant [ms]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">500.</span>        <span class="c1"># membrane capacitance [pF]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;R_L&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">50.</span>       <span class="c1"># leak Resistance [MOhm]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_init&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>   <span class="c1"># initial potential [mV]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;E_L&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>      <span class="c1"># leak reversal potential [mV]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>       <span class="c1"># refractory time (ms)</span>

    <span class="c1"># simulation parameters #</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">11.</span>  <span class="c1"># Total duration of simulation [ms]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.001</span>   <span class="c1"># Simulation time step [ms]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1">#delay from trial onset to stimulus onset [ms]</span>

    <span class="c1"># external parameters if any #</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">])</span><span class="o">-</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span>  <span class="c1"># Vector of discretized time points [ms]</span>

    <span class="k">return</span> <span class="n">pars</span>

<span class="k">def</span> <span class="nf">plot_volt_trace</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot trajetory of membrane potential for a single neuron</span>

<span class="sd">    Expects:</span>
<span class="sd">    pars   : parameter dictionary</span>
<span class="sd">    v      : volt trajetory</span>
<span class="sd">    sp     : spike train</span>

<span class="sd">    Returns:</span>
<span class="sd">    figure of the membrane potential trajetory for a single neuron</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hfig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">V_th</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_th&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span>
    <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span>
    <span class="k">if</span> <span class="n">sp</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="n">sp_num</span> <span class="o">=</span> <span class="p">(</span><span class="n">sp</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">v</span><span class="p">[</span><span class="n">sp_num</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">40</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span>  <span class="c1"># draw nicer spikes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">],</span> <span class="n">v</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">V_th</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;V)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="c1"># ax.set_xticks(fontsize=14)</span>
    <span class="c1"># ax.set_yticks(fontsize=14)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Membrane</span><span class="se">\n</span><span class="s1">potential&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Threshold V$_{\mathrm</span><span class="si">{th}</span><span class="s1">}$&#39;</span><span class="p">],</span>
             <span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.090</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.020</span><span class="p">])</span>

    
<span class="k">def</span> <span class="nf">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">Iinj</span><span class="p">,</span> <span class="n">durstep</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate the LIF dynamics with external input current</span>
<span class="sd">    Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    Iinj       : input current [pA]. The injected current here can be a value</span>
<span class="sd">                 or an array</span>
<span class="sd">    stop       : boolean. If True, use a current pulse</span>
<span class="sd">    Returns:</span>
<span class="sd">    rec_v      : membrane potential</span>
<span class="sd">    rec_sp     : spike times</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set parameters</span>
    <span class="n">V_th</span><span class="p">,</span> <span class="n">V_reset</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_th&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_reset&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span>  <span class="c1"># convert to V</span>
    <span class="n">R_L</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;R_L&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e6</span> <span class="c1">#convert to Ohm</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-9</span> <span class="c1"># convert to Farad</span>
    <span class="n">V_init</span><span class="p">,</span> <span class="n">E_L</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;V_init&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;E_L&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c1"># convert to V</span>
    <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;range_t&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c1"># convert to Sec</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span>
    <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>
    <span class="n">tref</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;tref&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span>

    <span class="c1"># Initialize voltage</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_init</span>

    <span class="c1"># Set current time course</span>
    <span class="n">Iinj</span> <span class="o">=</span> <span class="p">(</span><span class="n">Iinj</span><span class="o">*</span><span class="mf">1e-9</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
    <span class="n">durstep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(((</span><span class="n">durstep</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span><span class="o">*</span><span class="n">fs</span><span class="p">))</span>
    <span class="c1"># If current pulse, set beginning and end to 0</span>
    
    <span class="n">delay</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="mf">0.5</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span><span class="o">*</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">Iinj</span><span class="p">[:</span><span class="n">delay</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Iinj[:int(len(Iinj) / 2) - durstep] = 0</span>
    <span class="n">Iinj</span><span class="p">[(</span><span class="n">delay</span><span class="o">+</span><span class="n">durstep</span><span class="p">):]</span><span class="o">=</span><span class="mi">0</span> 
    <span class="c1"># Iinj[int(len(Iinj) / 2) + durstep:] = 0</span>

    <span class="c1"># Loop over time</span>
    <span class="n">rec_spikes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># record spike times</span>
    <span class="n">tr</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># the count for refractory duration</span>

    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">tr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># check if in refractory period</span>
            <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>  <span class="c1"># set voltage to reset</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># reduce running counter of refractory period</span>

        <span class="k">elif</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">V_th</span><span class="p">:</span>  <span class="c1"># if voltage over threshold</span>
            <span class="n">rec_spikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>  <span class="c1"># record spike event</span>
            <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>  <span class="c1"># reset voltage</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">tref</span> <span class="o">/</span> <span class="n">dt</span>  <span class="c1"># set refractory time</span>

        <span class="c1"># Calculate the increment of the membrane potential</span>
        <span class="c1"># dv = (-(v[it] - E_L) + Iinj[it] / g_L) * (dt / tau_m)</span>
        <span class="n">dv</span> <span class="o">=</span> <span class="p">(</span><span class="n">Iinj</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="p">((</span><span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">E_L</span><span class="p">)</span><span class="o">/</span><span class="n">R_L</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="n">C</span><span class="p">)</span>

        <span class="c1"># Update the membrane potential</span>
        <span class="n">v</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">dv</span>

    <span class="c1"># Get spike times in ms</span>
    <span class="n">rec_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rec_spikes</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="k">return</span> <span class="n">v</span><span class="p">,</span> <span class="n">rec_spikes</span>



<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">&#39;700px&#39;</span>
<span class="c1"># my_layout.description_width = &#39;initial&#39;</span>
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">}</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">current_injection</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">0.500</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">100.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">),</span>
    <span class="c1"># Simulation_Duration=widgets.FloatSlider(10., min=0.02, max=20., step=0.01,</span>
    <span class="c1">#                            layout=my_layout,style=style),</span>
    <span class="c1"># Injection_Step=widgets.Checkbox(value=True,</span>
    <span class="c1">#                            description=&#39;current step (vs continuous)&#39;,</span>
    <span class="c1">#                            layout=my_layout,style=style),</span>
    <span class="n">Current_Step_Duration</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">),</span>
    <span class="n">Equilibrium_Potential</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="o">-</span><span class="mf">75.</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="nb">max</span><span class="o">=-</span><span class="mf">30.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">),</span>
    <span class="n">Resistance</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">50.</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1000.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">),</span>
    <span class="c1"># AHP_Voltage=widgets.FloatSlider(-70., min=-100., max=-30.,step=2.,</span>
    <span class="c1">#                            layout=my_layout,style=style),</span>
    <span class="n">Spike_Threshold</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="o">-</span><span class="mf">55.</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">100.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=-</span><span class="mf">20.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">),</span>
    <span class="n">Capacitance</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">0.200</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span><span class="n">readout_format</span><span class="o">=</span><span class="s1">&#39;.3f&#39;</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">diff_DC</span><span class="p">(</span><span class="n">current_injection</span><span class="p">,</span>
            <span class="c1"># Simulation_Duration,</span>
            <span class="n">Current_Step_Duration</span><span class="p">,</span>
            <span class="n">Equilibrium_Potential</span><span class="p">,</span>
            <span class="n">Resistance</span><span class="p">,</span>
            <span class="n">Capacitance</span><span class="p">,</span>
            <span class="c1"># AHP_Voltage,</span>
            <span class="n">Spike_Threshold</span><span class="p">):</span> <span class="c1">#I_dc=200., tau_m=10.):</span>
    <span class="c1"># pars = default_pars(T=100.)</span>
    <span class="c1"># pars[&#39;tau_m&#39;] = tau_m</span>
    <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span>
      <span class="n">E_L</span> <span class="o">=</span> <span class="n">Equilibrium_Potential</span><span class="p">,</span>
      <span class="n">R_L</span> <span class="o">=</span> <span class="n">Resistance</span><span class="p">,</span>
      <span class="n">V_init</span> <span class="o">=</span> <span class="n">Equilibrium_Potential</span><span class="p">,</span>
      <span class="c1"># V_reset = AHP_Voltage,</span>
      <span class="n">V_th</span> <span class="o">=</span> <span class="n">Spike_Threshold</span><span class="p">,</span>
      <span class="c1"># tau_m = Membrane_Tau,</span>
      <span class="n">C</span> <span class="o">=</span> <span class="n">Capacitance</span><span class="p">)</span><span class="c1">#,</span>
      <span class="c1"># T = Simulation_Duration)</span>
    <span class="c1"># pars=default_pars()</span>
    <span class="n">v</span><span class="p">,</span> <span class="n">sp</span> <span class="o">=</span> <span class="n">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">Iinj</span><span class="o">=</span><span class="n">current_injection</span><span class="p">,</span><span class="n">durstep</span><span class="o">=</span><span class="n">Current_Step_Duration</span><span class="p">)</span>
    <span class="n">plot_volt_trace</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sp</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Interactive demo initiated at &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="p">(</span><span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">5</span><span class="p">)))));</span>
</pre></div>
</div>
</div>
</div>
<p><a id="one"></a></p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="strength-duration-tuning">
<h1>Strength-Duration Tuning<a class="headerlink" href="#strength-duration-tuning" title="Permalink to this headline">¶</a></h1>
<p>First, enter your stimulus duration and amplitude data into a .csv file. Then, you will import that .csv file so that you can fit a hyperbolic estimate to the data. Each row in the table should be a different stimulus condition. You should have a column in the table for stimulus duration and a column for each neuron’s amplitude data that you collected. The first row of the spreadsheet needs to contain a unique identifying header/name for each column.</p>
<div class="section" id="read-fit-and-plot-strength-duration-threshold-data">
<h2>Read, fit, and plot strength-duration threshold data<a class="headerlink" href="#read-fit-and-plot-strength-duration-threshold-data" title="Permalink to this headline">¶</a></h2>
<p>The following code cell will import the data from your .csv file and plot it as a scatterplot. Additionally, the data will be fit to the following hyperbolic equation:</p>
<div class="math notranslate nohighlight">
\[
a = r + \frac{(r*c)}{t}
\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is the stimulus amplitude, <span class="math notranslate nohighlight">\(r\)</span> is the rheobase, <span class="math notranslate nohighlight">\(c\)</span> is the chronaxie, and <span class="math notranslate nohighlight">\(t\)</span> is the stimulus duration. The fit <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(c\)</span> parameter values will be printed above the figure each time you run the code cell.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title {display-mode:&quot;form&quot;}</span>

<span class="c1">#@markdown Speficy the filepath to a csv file</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="s1">&#39;full filepath goes here&#39;</span> <span class="c1">#@param</span>
<span class="c1"># filepath = &#39;/Users/kperks/Documents/Teaching/Neurophysiology-Lab/modules/computational-model/Results-strength-duration.csv&#39; #@param</span>
<span class="c1">#@markdown Speficy the header name of one column you want for your x points</span>
<span class="n">x_column</span> <span class="o">=</span> <span class="s1">&#39;x_header&#39;</span> <span class="c1">#@param</span>
<span class="c1">#@markdown Speficy the header name of one column you want for your y points</span>
<span class="n">y_column</span> <span class="o">=</span> <span class="s1">&#39;y_header&#39;</span> <span class="c1">#@param</span>


<span class="c1">#@markdown Then run this code cell to plot the raw data and the estimated strength-duration curve for this one sample. </span>
<span class="c1">#@markdown The &#39;r&#39; and &#39;c&#39; values will be printed out above the data plot.</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<span class="n">hfig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_column</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_column</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="n">df_</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">x_column</span><span class="p">,</span> <span class="n">y_column</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">params</span><span class="p">,</span> <span class="n">covs</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">hyper_fit</span><span class="p">,</span> <span class="n">df_</span><span class="p">[</span><span class="n">x_column</span><span class="p">],</span><span class="n">df_</span><span class="p">[</span><span class="n">y_column</span><span class="p">],</span><span class="n">maxfev</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">)</span>

<span class="n">t_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">a_</span> <span class="o">=</span> <span class="n">hyper_fit</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span><span class="n">a_</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="c1"># ax.hlines(params[0],0,10,color = &#39;green&#39;)</span>
<span class="c1"># ax.hlines(2*params[0],0,10,color = &#39;green&#39;,linestyle=&#39;--&#39;)</span>
<span class="c1"># ax.vlines(params[1],0,2*params[0],color=&#39;purple&#39;,linestyle=&#39;--&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude (v)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;duration (ms)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;r = </span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">; c = </span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="compare-strength-duration-tuning-across-neurons">
<h2>Compare strength-duration tuning across neurons<a class="headerlink" href="#compare-strength-duration-tuning-across-neurons" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title {display-mode:&quot;form&quot;}</span>

<span class="c1">#@markdown Specify the rheobase for each neuron</span>
<span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">]</span> <span class="c1">#@param</span>
<span class="c1">#@markdown Specify the chronaxie for each neuron</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">]</span> <span class="c1">#@param</span>
<span class="c1">#@markdown Specify a label for each sample</span>
<span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;neuron 1 ID&#39;</span><span class="p">,</span> <span class="s1">&#39;neuron 2 ID&#39;</span><span class="p">]</span> <span class="c1">#@param</span>
<span class="c1">#@markdown Specify whether you want to plot the x-axis as &#39;log&#39; or &#39;linear&#39;</span>
<span class="n">x_axis_scale</span> <span class="o">=</span> <span class="s1">&#39;log&#39;</span>

<span class="c1">#@markdown Then run this code cell to plot the estimated strength-duration curve for each sample. </span>
<span class="c1">#@markdown The chronaxie will be marked with scatter dot and a gray line connected to the x-axis for each sample.</span>

<span class="n">t_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">hfig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">r_</span><span class="p">,</span><span class="n">c_</span><span class="p">,</span><span class="n">label_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">label</span><span class="p">):</span>
    
    <span class="n">a_</span> <span class="o">=</span> <span class="n">hyper_fit</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span><span class="n">r_</span><span class="p">,</span><span class="n">c_</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span><span class="n">a_</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label_</span><span class="p">)</span>
    <span class="c1"># ax.scatter(c_,2*r_,zorder=3)</span>
    <span class="c1"># ax.vlines(c_,0,2*r_,color=&#39;gray&#39;)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude (v)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;duration (ms)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">x_axis_scale</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<hr> 
Written by Dr. Krista Perks for courses taught at Wesleyan University.<p><a id="setup"></a></p>
<p><a id="one"></a></p>
<p><a id="two"></a></p>
<p><a id="three"></a></p>
<p><a id="four"></a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./modules/computational-model"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Lab-Manual_computational-model.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Lab Manual</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Responses_computational-model.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Responses</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Dr. Krista Perks<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>
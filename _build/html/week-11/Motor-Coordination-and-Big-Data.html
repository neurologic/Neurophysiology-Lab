
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Motor Coordination and Big Data &#8212; Neurophysiology Lab</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Week 12 Big Data and Robotic Control" href="../week-12/week-12.html" />
    <link rel="prev" title="Week 11 Motor Coordination and Big Data" href="week-11.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/NeuronImage_CourseHeader.jpeg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Neurophysiology Lab</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to Neurophysiology Lab
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  General
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../standards.html">
   Standards
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../howto/howto.html">
   How To Guides
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../howto/Python-Introduction-Coding-Light.html">
     Introduction to Python Notebooks
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Weekly Materials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week-1/week-1.html">
   Week 1. Introduction to Passive Physiology Principles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week-1/Passive-Membrane-Properties.html">
     Passive Membrane Properties
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week-1/Passive-Membrane-Properties_Responses.html">
     Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week-2/week-2.html">
   Week 2 Dynamic Electrical Signals
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week-2/Electric-Organ-Discharge.html">
     Electric Organ Discharge
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week-3/week-3.html">
   Week 3 Experimental Design for Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week-4/week-4.html">
   Week 4 Sensory Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week-5/week-5.html">
   Week 5 Sensory Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week-6/week-6.html">
   Week 6 Motor Nerve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week-7/week-7.html">
   Week 7 Intracellular Recording Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week-8/week-8.html">
   Week 8  Synaptic Connectivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week-9/week-9.html">
   Week 9 Synaptic Plasticity
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week-10/week-10.html">
   Week 10 Human Motor Neuron Activity
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week-10/Human-Motor-Neuron-Coding.html">
     Human Motor Neuron Activity
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="week-11.html">
   Week 11 Motor Coordination and Big Data
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Motor Coordination and Big Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week-12/week-12.html">
   Week 12 Big Data and Robotic Control
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week-12/Geometric-View-Of-Data-Tutorial.html">
     Tutorial: Geometric view of data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week-12/Dimensionality-Reduction-Tutorial.html">
     Dimensionality Reduction Tutorial
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week-13/week-13.html">
   Week 13 Neural Circuits
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Wrapping Up
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../closure/closure.html">
   Closure
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/week-11/Motor-Coordination-and-Big-Data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/neurologic/Neurophysiology-Lab"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/neurologic/Neurophysiology-Lab/issues/new?title=Issue%20on%20page%20%2Fweek-11/Motor-Coordination-and-Big-Data.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/neurologic/Neurophysiology-Lab/main?urlpath=tree/week-11/Motor-Coordination-and-Big-Data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/neurologic/Neurophysiology-Lab/blob/main/week-11/Motor-Coordination-and-Big-Data.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Motor Coordination and Big Data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-i-plot-the-raw-emg-signal-from-each-muscle">
   Part I. Plot the raw EMG signal from each muscle
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-ii-plot-the-rectified-smoothed-amplitude-envelope">
   Part II. Plot the rectified, smoothed “amplitude envelope”
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-iii-analyze-a-selection-of-the-data">
   Part III. Analyze a selection of the data.
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-iv-muscle-coordination">
   Part IV. Muscle coordination
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-v-dimensionality-reduction">
   Part V. Dimensionality Reduction
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Motor Coordination and Big Data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Motor Coordination and Big Data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-i-plot-the-raw-emg-signal-from-each-muscle">
   Part I. Plot the raw EMG signal from each muscle
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-ii-plot-the-rectified-smoothed-amplitude-envelope">
   Part II. Plot the rectified, smoothed “amplitude envelope”
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-iii-analyze-a-selection-of-the-data">
   Part III. Analyze a selection of the data.
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-iv-muscle-coordination">
   Part IV. Muscle coordination
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-v-dimensionality-reduction">
   Part V. Dimensionality Reduction
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <p><a href="https://colab.research.google.com/github/neurologic/Neurophysiology-Lab/blob/main/week-11/Motor-Coordination-and-Big-Data.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a></p>
<p><a id="intro"></a></p>
<div class="tex2jax_ignore mathjax_ignore section" id="motor-coordination-and-big-data">
<h1>Motor Coordination and Big Data<a class="headerlink" href="#motor-coordination-and-big-data" title="Permalink to this headline">¶</a></h1>
<p>This notebook provides tools for interacting with multi-channel EMG data collected using differential electrodes, Backyard Brains amplifiers, Nidaq acquisition hardware, and Bonsai-rx recording software.</p>
<p>Throughout the notebook, you will plot both raw and processed data.</p>
<ul class="simple">
<li><p>You can interact with the plots by zooming in and panning. <br></p></li>
<li><p>You can save the current plot view at any time by hitting the “download” icon - it will save to your Downloads folder. Make sure to re-name the auto-generated file and make notes about what you plotted right away. <br></p></li>
</ul>
<p>The plotting tools available in this notebook include:</p>
<ul class="simple">
<li><p>raw EMG data with each channel plotted separately</p></li>
<li><p>emg amplitude envelopes with each channel plotted separately</p></li>
<li><p>selected subsets of emg amplitude envelopes overlaid on the same plot</p></li>
<li><p>3D plotting of the first 3 principal components of muscle activity for a specific range of data selected</p></li>
</ul>
<p>The data processing and analysis tools available in this notebook include:</p>
<ul class="simple">
<li><p>amplitude envelope smoothing</p></li>
<li><p>data range selection within a file</p></li>
<li><p>correlation of activity (of the amplitude envelopes) across recording channels</p></li>
<li><p>Principle Component Analysis on all recorded channels (channels may be dropped from the analysis in the step when you load the data)</p></li>
</ul>
<p><a id="toc"></a></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h1>
<ol class="simple">
<li><p><a class="reference external" href="#intro">Introduction</a></p></li>
<li><p><a class="reference external" href="#setup">Setup</a></p></li>
<li><p><a class="reference external" href="#one">Part I. Raw EMG Signal</a></p></li>
<li><p><a class="reference external" href="#two">Part II. Select Data</a></p></li>
<li><p><a class="reference external" href="#three">Part III. EMG envelope</a></p></li>
<li><p><a class="reference external" href="#four">Part IV. Muscle Coordination</a></p></li>
</ol>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="#toc">toc</a></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown Run this code cell to load packages and { display-mode: &quot;form&quot; }</span>
<span class="c1">#@markdown initialize the notebook.</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="c1"># import matplotlib.pyplot as plt</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">hilbert</span><span class="p">,</span><span class="n">medfilt</span><span class="p">,</span><span class="n">resample</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span><span class="n">timezone</span><span class="p">,</span><span class="n">timedelta</span>
<span class="n">pal</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">n_colors</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">pal</span> <span class="o">=</span> <span class="n">pal</span><span class="o">.</span><span class="n">as_hex</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown **TASK:** Run this code cell to mount your Google Drive. { display-mode: &quot;form&quot; }</span>

<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown **TASK:** Run this code cell to load the EMG dataset you will explore and analyze. { display-mode: &quot;form&quot; }</span>

<span class="n">emg_filepath</span> <span class="o">=</span> <span class="s2">&quot;file path in colab&quot;</span> <span class="c1">#@param</span>

<span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">NaN</span> <span class="c1">#@param</span>
<span class="n">number_channels</span> <span class="o">=</span> <span class="n">NaN</span> <span class="c1">#@param</span>
<span class="n">drop_channels</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#@param</span>

<span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">emg_filepath</span><span class="p">)</span>

<span class="c1"># No need to edit below this line</span>
<span class="c1">#################################</span>
<span class="n">emg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">emg</span> <span class="o">=</span> <span class="n">emg</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">number_channels</span><span class="p">)</span>
<span class="n">dur</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">emg</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">sampling_rate</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;duration of recording was </span><span class="si">%0.2f</span><span class="s1"> seconds&#39;</span> <span class="o">%</span><span class="k">dur</span>)
<span class="n">newfs</span> <span class="o">=</span> <span class="mi">2500</span>
<span class="n">chunksize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sampling_rate</span><span class="o">/</span><span class="n">newfs</span><span class="p">)</span>
<span class="n">emg</span> <span class="o">=</span> <span class="n">emg</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="n">chunksize</span><span class="p">,:]</span>
<span class="n">newfs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">emg</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">dur</span>

<span class="c1"># nerve = y_data[:,nerve_channel] - np.median(y_data[:,nerve_channel],0)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">emg</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">newfs</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">emg</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># muscle = y_data[:,muscle_channel]</span>

<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">number_channels</span><span class="p">)]</span>
<span class="n">df_emg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">emg</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drop_channels</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="n">drop_channels</span><span class="p">:</span>
    <span class="n">df_emg</span> <span class="o">=</span> <span class="n">df_emg</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">))</span>
  <span class="n">number_channels</span> <span class="o">=</span> <span class="n">number_channels</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">drop_channels</span><span class="p">)</span>

<span class="c1"># Use rectfication and gaussian smoothing on EMG to get mean-centered rate</span>
<span class="n">df_rate</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({})</span>
<span class="n">filter_dur</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="c1">#@param</span>
<span class="n">filtert</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filter_dur</span><span class="o">*</span><span class="n">sampling_rate</span><span class="p">)</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_emg</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span> <span class="c1"># rename headers as input channels</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df_emg</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df_emg</span><span class="p">[</span><span class="n">h</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="c1">#takes the absolute value of </span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">filtert</span><span class="p">)</span>
    <span class="n">df_rate</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p><a id="one"></a></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="part-i-plot-the-raw-emg-signal-from-each-muscle">
<h1>Part I. Plot the raw EMG signal from each muscle<a class="headerlink" href="#part-i-plot-the-raw-emg-signal-from-each-muscle" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="#toc">toc</a></p>
<p>The amplitude units of the EMG signal are in Volts, but the amplitude was amplified before being recorded. The amplification factor was approximately 1000, so 1V recorded was really 1mV measured at the electrode.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown **TASK:** First, specify a time range to plot. { display-mode: &quot;form&quot; }</span>
<span class="c1">#@markdown This is just necessary because these data files are so large.</span>
<span class="c1">#@markdown If you tried to plot all of the data at once the Google Colab kernel will &quot;die.&quot;</span>
<span class="c1">#@markdown If you need a plot of the whole time range of the recording, let me know </span>
<span class="c1">#@markdown and I can make one for you using a program local to my computer. </span>
<span class="c1">#@markdown &gt;Note: You could look at the simulataneously recorded</span>
<span class="c1">#@markdown video for guidance on time ranges to peak at if needed.</span>
<span class="c1">#@markdown &lt;br&gt; If you try to plot more than 200 seconds total of data</span>
<span class="c1">#@markdown (so about 20-30 seconds for 9 channels or 40-60 seconds for 5 channels), </span>
<span class="c1">#@markdown the plot will &quot;time out&quot; and not show up.</span>

<span class="n">time_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span> <span class="c1">#@param</span>

<span class="c1">#@markdown Then, Run this cell to plot the raw EMG data.</span>
<span class="c1">#@markdown You can zoom in and scroll around to explore the data. </span>


<span class="n">plotmask</span> <span class="o">=</span> <span class="p">((</span><span class="n">time</span><span class="o">&gt;</span><span class="n">time_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">time</span><span class="o">&lt;</span><span class="n">time_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">number_channels</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">vertical_spacing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">shared_xaxes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">chan</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df_emg</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">plotmask</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df_emg</span><span class="p">[</span><span class="n">plotmask</span><span class="p">][</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">name</span><span class="o">=</span><span class="n">chan</span><span class="p">),</span>
                <span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;time(seconds)&quot;</span><span class="p">,</span> 
                  <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># fig.layout.yaxis.showticklabels=False</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Task completed at &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="p">(</span><span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">5</span><span class="p">)))))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><a id="two"></a></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="part-ii-plot-the-rectified-smoothed-amplitude-envelope">
<h1>Part II. Plot the rectified, smoothed “amplitude envelope”<a class="headerlink" href="#part-ii-plot-the-rectified-smoothed-amplitude-envelope" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="#toc">toc</a></p>
<p>This is a type of <em>signal processing</em> that transforms raw EMG activity (a bipolar signal - both positive and negative values) into what we refer to as the <em>amplitude envelope</em> of the EMG activity. The “smoothing” of the envelope results in a waveform that reflects both the amplitude and the rate of the raw EMG signal (accounts for both spatial and temporal summation). Therefore, absolute voltage information is lost, but you can still compare relative voltage across channels and across recordings that used the same electrode configurations.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown **TASK:** First, specify a time range to plot. { display-mode: &quot;form&quot; }</span>
<span class="c1">#@markdown This is just necessary because these data files are so large.</span>
<span class="c1">#@markdown If you tried to plot all of the data at once the Google Colab kernel will &quot;die.&quot;</span>
<span class="c1">#@markdown If you need a plot of the whole time range of the recording, let me know </span>
<span class="c1">#@markdown and I can make one for you using a program local to my computer. </span>
<span class="c1">#@markdown &gt;Note: You could look at the simulataneously recorded</span>
<span class="c1">#@markdown video for guidance on time ranges to peak at if needed.</span>
<span class="c1">#@markdown &lt;br&gt; If you try to plot more than 200 seconds total of data</span>
<span class="c1">#@markdown (so about 20-30 seconds for 9 channels or 40-60 seconds for 5 channels), </span>
<span class="c1">#@markdown the plot will &quot;time out&quot; and not show up.</span>

<span class="n">time_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span> <span class="c1">#@param</span>

<span class="c1">#@markdown Then, Run this cell to plot the envelope of the EMG data.</span>
<span class="c1">#@markdown You can zoom in and scroll around to explore the data. </span>


<span class="n">plotmask</span> <span class="o">=</span> <span class="p">((</span><span class="n">time</span><span class="o">&gt;</span><span class="n">time_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">time</span><span class="o">&lt;</span><span class="n">time_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">number_channels</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">vertical_spacing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">shared_xaxes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">chan</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df_rate</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
  <span class="c1"># if plot_raw:</span>
  <span class="c1">#   fig.add_trace(go.Scatter(x = time, y = (df_emg[chan].values)/5,</span>
  <span class="c1">#                        name=chan),</span>
  <span class="c1">#               row=i+1,col=1)</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">plotmask</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df_rate</span><span class="p">[</span><span class="n">plotmask</span><span class="p">][</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">name</span><span class="o">=</span><span class="n">chan</span><span class="p">),</span>
                <span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;time(seconds)&quot;</span><span class="p">,</span> 
                  <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Task completed at &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="p">(</span><span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">5</span><span class="p">)))))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown Overlay channels on same axis { display-mode: &quot;form&quot; }</span>

<span class="c1">#@markdown **TASK:** First, specify a time range and set of channels to plot.</span>
<span class="c1">#@markdown Remember that the first channel is numbered 0.</span>
<span class="c1">#@markdown &gt;Note: If you plot less channels, you can plot more time.</span>
<span class="c1">#@markdown If the plot does not show up after the cell finishes, pick less data.</span>

<span class="n">time_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span> <span class="c1">#@param</span>
<span class="n">channels_to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="c1">#@param</span>

<span class="c1">#@markdown Then, Run this cell to make an overlaid plot </span>
<span class="c1">#@markdown of the envelope of the EMG data on the selected channels.</span>
<span class="c1">#@markdown You can zoom in and scroll around to explore the data. </span>

<span class="n">plotmask</span> <span class="o">=</span> <span class="p">((</span><span class="n">time</span><span class="o">&gt;</span><span class="n">time_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">time</span><span class="o">&lt;</span><span class="n">time_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">chan</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">channels_to_plot</span><span class="p">):</span>
  <span class="n">chan</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">plotmask</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df_rate</span><span class="p">[</span><span class="n">plotmask</span><span class="p">][</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">name</span><span class="o">=</span><span class="n">chan</span><span class="p">,</span><span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;time(seconds)&quot;</span><span class="p">,</span> 
                  <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Task completed at &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="p">(</span><span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">5</span><span class="p">)))))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><a id="three"></a></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="part-iii-analyze-a-selection-of-the-data">
<h1>Part III. Analyze a selection of the data.<a class="headerlink" href="#part-iii-analyze-a-selection-of-the-data" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="#toc">toc</a></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown Pick a time window to analyze that has the section  { display-mode: &quot;form&quot; }</span>
<span class="c1">#@markdown of movement you want to analyze </span>
<span class="c1">#@markdown and enter it in the code cell below.</span>
<span class="c1">#@markdown &gt; Note: get the time by hovering over the data plot. </span>
<span class="c1">#@markdown - **start** = the start time of the section you want to analyze (seconds).</span>
<span class="c1">#@markdown - **stop** = the stop time of the section you want to analyze (seconds).</span>

<span class="n">start</span> <span class="o">=</span>  <span class="mf">36.5</span><span class="c1">#@param {type:&quot;number&quot;}</span>
<span class="n">stop</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1">#@param {type:&quot;number&quot;}</span>

<span class="c1">#@markdown &lt;b&gt;Task:&lt;/b&gt; After you have specified the start and stop times,</span>
<span class="c1">#@markdown run this cell to execute the variable assignment.</span>
<span class="c1"># df_vid_selection = df_vid[((df_vid[&#39;time&#39;]&gt;(start)) &amp; (df_vid[&#39;time&#39;]&lt;(stop)))] # select start:stop section</span>
<span class="c1"># df_emg_select = df_emg[((time&gt;start) &amp; (time&lt;stop))]</span>
<span class="n">df_rate_select</span> <span class="o">=</span> <span class="n">df_rate</span><span class="p">[((</span><span class="n">time</span><span class="o">&gt;</span><span class="n">start</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">time</span><span class="o">&lt;</span><span class="n">stop</span><span class="p">))]</span>
<span class="n">time_select</span> <span class="o">=</span> <span class="n">time</span><span class="p">[((</span><span class="n">time</span><span class="o">&gt;</span><span class="n">start</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">time</span><span class="o">&lt;</span><span class="n">stop</span><span class="p">))]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;all set - analysis domain defined&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Task completed at &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="p">(</span><span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">5</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
</div>
<p><a id="four"></a></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="part-iv-muscle-coordination">
<h1>Part IV. Muscle coordination<a class="headerlink" href="#part-iv-muscle-coordination" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="#toc">toc</a></p>
<p>Think about how you would qualitatively describe the relationship between the two muscle signals that you plotted. The correlation metric is often helpful to quantify the relationship between signals. Essentially, correlation is the measure of how two or more variables are related to one another. https://en.wikipedia.org/wiki/Correlation</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown &lt;b&gt;Task:&lt;/b&gt; Run this cell to calculate the { display-mode: &quot;form&quot; }</span>
<span class="c1">#@markdown mathematical correlation values between the two signals.</span>
<span class="c1">#@markdown The results will be shown in table and matrix format.</span>

<span class="c1"># No need to edit this code cell</span>
<span class="c1">################################</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;correlation matrix:&#39;</span><span class="p">)</span>
<span class="n">p_corr</span> <span class="o">=</span> <span class="n">df_rate_select</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">p_corr</span><span class="p">)</span>
<span class="n">hfig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">p_corr</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p><a id="five"></a></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="part-v-dimensionality-reduction">
<h1>Part V. Dimensionality Reduction<a class="headerlink" href="#part-v-dimensionality-reduction" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="#toc">toc</a></p>
<p>Use principal component analysis to observe the activity of all muscles simultaneously in the context of the dominant signals from the population activity.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown &lt;b&gt;Task:&lt;/b&gt; Run this cell to do a Principal Component Analysis { display-mode: &quot;form&quot; }</span>
<span class="c1">#@markdown (PCA) on the selected data.</span>
<span class="c1">#@markdown You will get a plot of the explained variance for each PC.</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df_rate_select</span>
<span class="n">df</span> <span class="o">=</span><span class="p">(</span><span class="n">df</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">n_components</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># if try to take more components than have channels, use amount of channels</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df_pca</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PC</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_components</span><span class="p">)],</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Your data has now been transformed into &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_components</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; principle components.&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_pca</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">,</span> 
                                 <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span><span class="n">marker_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Principal Components&quot;</span><span class="p">,</span> 
                  <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Explained Variance&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">350</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown &lt;b&gt;Task:&lt;/b&gt; Run this cell to plot the data in the space defined by { display-mode: &quot;form&quot; }</span>
<span class="c1">#@markdown the first three principle components of the selected data.</span>
<span class="c1">#@markdown The start and stop locations of the trajectory are marked by green and purple dots (respectively).</span>
<span class="c1">#@markdown &gt; Note: The plot sometimes starts zoomed far in. </span>
<span class="c1">#@markdown Hit the &quot;home&quot; button and/or zoom out. You can then </span>
<span class="c1">#@markdown zoom back in as needed.</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;PC0&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;PC1&#39;</span><span class="p">],</span> <span class="n">z</span><span class="o">=</span><span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;PC2&#39;</span><span class="p">],</span>
                                   <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;trajectory&#39;</span><span class="p">,</span><span class="n">marker_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;PC0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;PC1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;PC2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                   <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="n">marker_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;PC0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;PC1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;PC2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
                                   <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;stop&#39;</span><span class="p">,</span><span class="n">marker_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">scene</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">xaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;PC0&#39;</span><span class="p">),</span>
        <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;PC1&#39;</span><span class="p">),</span>
        <span class="n">zaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;PC2&#39;</span><span class="p">)),</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">600</span><span class="p">)</span>
    
   

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./week-11"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="week-11.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Week 11 Motor Coordination and Big Data</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../week-12/week-12.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 12 Big Data and Robotic Control</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Dr. Krista Perks<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>